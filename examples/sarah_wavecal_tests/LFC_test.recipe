from modules.wavelength_cal.src.wavelength_cal import WaveCalibrate

L1_file = config.ARGUMENT.input_dir + config.ARGUMENT.obs_prefix + config.ARGUMENT.obs_list[0] + '.fits'
master_file = config.ARGUMENT.master_wls_file + '.fits'

lfc_data = kpf1_from_fits(L1_file, data_type='NEID')

quicklook = False

# use wls from L1 NEID file as master solution
wave_soln, _ = WaveCalibrate(lfc_data, quicklook, master_wavelength=master_file, f0='LFCF0', fr='LFCFR', data_type='NEID')

obsname = config.ARGUMENT.obs_prefix + config.ARGUMENT.obs_list[0]
output_filename = config.ARGUMENT.output_dir + obsname + config.ARGUMENT.lev1_suffix + '_wave' + '.fits'
result = to_fits(wave_soln, output_filename)