from modules.order_trace.src.order_trace import OrderTrace

input_file_pattern = config.ARGUMENT.input_file_pattern
data_type = config.ARGUMENT.data_type
stem_suffix = config.ARGUMENT.output_file_stem_suffix
output_dir = config.ARGUMENT.output_dir

for input_file in find_files(input_file_pattern):
    _, short_file = split(input_file)
    stem, ext = splitext(short_file)
    output_file = output_dir + '/' + stem + stem_suffix + ext
    data = kpf0_from_fits(input_file, data_type=data_type)
    data = OrderTrace(data)
    result = to_fits(data, output_file)
