from modules.utils.frame_combine import FrameCombinePrimitive
from modules.utils.orientation_ref_reader import OrientationReference
from modules.bias_subtraction.src.bias_subtraction import BiasSubtraction 

channel_keys = OrientationReference(channel_orientation_ref_path)

bias_files=find_files(KPFPIPE_TEST_DATA+'/NEIDdata/BIAS/neidTemp*.fits')
master_bias_data=FrameCombinePrimitive(bias_files, 'NEID')

for frame in find_files(##raw_frame_dir##):
    for key in channel_keys:
        assembled_frame = BiasSubtraction(frame, key, master_bias_data, 'NEID')
        assembled_frame = to_fits(assembled_frame, ##result_path_name##)
